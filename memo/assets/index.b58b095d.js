import{g as d,o as f,c as p,u as m,f as S,h as v,j as g,k as M,a as j,l as O,r as w}from"./index.ee9e1910.js";var T=(e,o)=>{let r;const s=()=>clearTimeout(r);return d()&&f(s),Object.assign((...n)=>{r!==void 0&&s(),r=setTimeout(()=>e(...n),o)},{clear:s})},C=(e,o)=>{let r=!1,s,c;const n=(...t)=>{c=t,!r&&(r=!0,s=setTimeout(()=>{e(...c),r=!1},o))},a=()=>{clearTimeout(s),r=!1};return d()&&f(a),Object.assign(n,{clear:a})},x=()=>{};function z(e){return e!==null&&(typeof e=="object"||typeof e=="function")}function b(e,...o){return typeof e=="function"?e(...o):e}var W=Object.entries,P=Object.keys,R=e=>d()?f(e):e,V=()=>{let e=[];const o=()=>e=[];return{push:(...r)=>e.push(...r),execute(r,s,c,n){e.forEach(a=>a(r,s,c,n)),o()},clear:o}};function D(e){const o={...e},r={},s=new Map,c=t=>{const i=s.get(t);if(i)return i[0]();const u=p(o[t],{name:typeof t=="string"?t:void 0});return s.set(t,u),delete o[t],u[0]()},n=(t,i)=>{const u=s.get(t);if(u)return u[1](i);t in o&&(o[t]=b(i,[o[t]]))};for(const t of P(e))r[t]=void 0,Object.defineProperty(r,t,{get:c.bind(void 0,t)});return[r,(t,i)=>(z(t)?m(()=>{S(()=>{for(const[u,l]of W(b(t,r)))n(u,()=>l)})}):n(t,i),r)]}const k=e=>o=>{e(()=>o)},A=(e,o)=>e.length>0?()=>e(m(o)):e;function y(e,o){const r=d(),s=new Set;let c=0,n=!1;return f(()=>{for(const a of s)a();s.clear(),n=!0}),a=>{if(n){m(a);return}c++,j(t=>{s.add(t);let i=!0;v(()=>{if(i)return i=!1,a();--c===0&&m(e),t(),s.delete(t)},o)},r)}}function E(e,o,r){const[s,c]=p(e(o),r),n=A(e,s);return v(g(n,k(c),{defer:!0})),[s,c]}function q(e,o,r,s,c){let n=!0;const[a,t]=p((()=>{let u;return v(g(e,(l,h)=>{n?(u=o(l,h,s),n=!1):i(l,h)})),u})(),c),i=T((u,l)=>{t(()=>o(u,l,a()))},r);return a}function B(e,o,r,s){let c=x;const n=y(()=>c()),[a,t]=p((()=>{let i;return n(()=>i=e(r)),i})(),s);return c=C(()=>n(()=>t(e)),o),a}function G(e,o={}){const[r,s]=p(o.value,o),c=[];return v(async()=>{const n=e(m(r));n instanceof Promise?(c.push(n),n.then(a=>c.includes(n)&&s(()=>a)),n.finally(()=>{const a=c.indexOf(n);c.splice(0,a+1)})):s(()=>n)},void 0),r}function I(e,o,r){const s=d()??void 0;let c=0,n=o,a=!0,t,i,u=!1;f(()=>{i&&i(),u=!0});const l=y(()=>a=!t);return()=>u||!M()?t?t():(a&&(l(()=>n=e(n)),a=!1),n):(c++,f(()=>c--),t||j(h=>{i=h,t=O(()=>c?n=e(n):(i(),i=t=void 0,n),n,r)},s),t())}function H(...e){const o=new Map,r=d(),s=typeof e[1]=="function"?e[0]:void 0,c=typeof e[1]=="function"?e[1]:e[0],n=typeof e[1]=="object"?e[1]:typeof e[2]=="object"?e[2]:{},a=t=>{if(o.has(t))return o.get(t)();const i=w(r,()=>I(u=>c(t,u),void 0,n));return(n.size===void 0||o.size<n.size)&&o.set(t,i),i()};return s?()=>a(s()):a}export{G as a,V as b,I as c,D as d,q as e,B as f,H as g,E as h,R as t};
